<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ConditionFormatter.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Card Fraud Rule Engine</a> &gt; <a href="index.source.html" class="el_package">com.fraud.engine.domain</a> &gt; <span class="el_source">ConditionFormatter.java</span></div><h1>ConditionFormatter.java</h1><pre class="source lang-java linenums">package com.fraud.engine.domain;

import java.util.List;

/**
 * Formats Condition objects into human-readable strings.
 * &lt;p&gt;
 * This class is extracted from Condition.java to separate formatting concerns
 * from the core evaluation logic. It provides consistent formatting for:
 * &lt;ul&gt;
 *   &lt;li&gt;Operator symbols (e.g., &quot;&gt;&quot; instead of &quot;GT&quot;)&lt;/li&gt;
 *   &lt;li&gt;Value formatting (e.g., quoting strings, listing collections)&lt;/li&gt;
 *   &lt;li&gt;Human-readable condition descriptions&lt;/li&gt;
 * &lt;/ul&gt;
 */
public final class ConditionFormatter {

    private ConditionFormatter() {
    }

    /**
     * Formats a condition into a human-readable string.
     * Example outputs: &quot;amount &gt; 5000&quot;, &quot;country IN (US, CA, UK)&quot;
     *
     * @param condition the condition to format
     * @return a formatted string representation
     */
    public static String toHumanReadable(Condition condition) {
<span class="fc bfc" id="L29" title="All 2 branches covered.">        if (condition == null) {</span>
<span class="fc" id="L30">            return &quot;null&quot;;</span>
        }

<span class="fc" id="L33">        String opSymbol = getOperatorSymbol(condition.getOperatorEnum());</span>
<span class="fc" id="L34">        String formattedValue = formatValue(condition);</span>
<span class="fc" id="L35">        return condition.getField() + &quot; &quot; + opSymbol + &quot; &quot; + formattedValue;</span>
    }

    /**
     * Formats the condition's value for display.
     *
     * @param condition the condition
     * @return the formatted value string
     */
    static String formatValue(Condition condition) {
<span class="pc bpc" id="L45" title="1 of 2 branches missed.">        if (condition == null) {</span>
<span class="nc" id="L46">            return &quot;null&quot;;</span>
        }

<span class="fc bfc" id="L49" title="All 2 branches covered.">        Object val = condition.getValues() != null ? condition.getValues() : condition.getValue();</span>
<span class="fc bfc" id="L50" title="All 2 branches covered.">        if (val == null) {</span>
<span class="fc" id="L51">            return &quot;null&quot;;</span>
        }
<span class="fc bfc" id="L53" title="All 2 branches covered.">        if (val instanceof List&lt;?&gt; list) {</span>
<span class="fc" id="L54">            return &quot;(&quot; + list.stream()</span>
<span class="fc" id="L55">                    .map(ConditionFormatter::formatSingleValue)</span>
<span class="fc" id="L56">                    .collect(java.util.stream.Collectors.joining(&quot;, &quot;)) + &quot;)&quot;;</span>
        }
<span class="fc" id="L58">        return formatSingleValue(val);</span>
    }

    /**
     * Formats a single value for display.
     *
     * @param val the value to format
     * @return the formatted value string
     */
    private static String formatSingleValue(Object val) {
<span class="pc bpc" id="L68" title="1 of 2 branches missed.">        if (val == null) {</span>
<span class="nc" id="L69">            return &quot;null&quot;;</span>
        }
<span class="fc bfc" id="L71" title="All 2 branches covered.">        if (val instanceof String) {</span>
<span class="fc" id="L72">            return &quot;'&quot; + val + &quot;'&quot;;</span>
        }
<span class="fc" id="L74">        return String.valueOf(val);</span>
    }

    /**
     * Gets the operator symbol for display.
     *
     * @param operator the operator enum
     * @return the symbol string
     */
    public static String getOperatorSymbol(Condition.Operator operator) {
<span class="fc bfc" id="L84" title="All 2 branches covered.">        if (operator == null) {</span>
<span class="fc" id="L85">            return &quot;=&quot;;</span>
        }
<span class="fc bfc" id="L87" title="All 14 branches covered.">        return switch (operator) {</span>
<span class="fc" id="L88">            case GT -&gt; &quot;&gt;&quot;;</span>
<span class="fc" id="L89">            case GTE -&gt; &quot;&gt;=&quot;;</span>
<span class="fc" id="L90">            case LT -&gt; &quot;&lt;&quot;;</span>
<span class="fc" id="L91">            case LTE -&gt; &quot;&lt;=&quot;;</span>
<span class="fc" id="L92">            case EQ -&gt; &quot;=&quot;;</span>
<span class="fc" id="L93">            case NE -&gt; &quot;!=&quot;;</span>
<span class="fc" id="L94">            case IN -&gt; &quot;IN&quot;;</span>
<span class="fc" id="L95">            case NOT_IN -&gt; &quot;NOT IN&quot;;</span>
<span class="fc" id="L96">            case BETWEEN -&gt; &quot;BETWEEN&quot;;</span>
<span class="fc" id="L97">            case CONTAINS -&gt; &quot;CONTAINS&quot;;</span>
<span class="fc" id="L98">            case STARTS_WITH -&gt; &quot;STARTS WITH&quot;;</span>
<span class="fc" id="L99">            case ENDS_WITH -&gt; &quot;ENDS WITH&quot;;</span>
<span class="fc" id="L100">            case REGEX -&gt; &quot;MATCHES&quot;;</span>
<span class="fc" id="L101">            case EXISTS -&gt; &quot;EXISTS&quot;;</span>
        };
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>